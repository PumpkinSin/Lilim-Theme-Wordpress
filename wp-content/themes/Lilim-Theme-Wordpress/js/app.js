function grin(t){var e;if(t=" "+t+" ",!document.getElementById("comment")||"textarea"!=document.getElementById("comment").type)return!1;if(e=document.getElementById("comment"),document.selection){e.focus();var i=document.selection.createRange();i.text=t,e.focus()}else if(e.selectionStart||"0"==e.selectionStart){var o=e.selectionStart,n=e.selectionEnd,a=n;e.value=e.value.substring(0,o)+t+e.value.substring(n,e.value.length),a+=t.length,e.focus(),e.selectionStart=a,e.selectionEnd=a}else e.value+=t,e.focus()}var RikaSite=RikaSite||{};if(jQuery(document).ready(function(t){"use strict";RikaSite=function(){},RikaSite.prototype={init:function(){var e=this,i=t("#post .column--invisible .list--post");e.hoverSearchText(),e.initial(i),e.placeToolbar(960,60,20),e.ajaxPostLoading(),e.responsiveColumn(i),e.navDropDownClick(),e.navFilterClick(),e.menuScroll(),e.upperDownClick(),e.toolBarPlace(),e.dispalyMoblieMenu(),e.tagPost(),e.ScrollMenuMobile(),e.searchClick(),e.layoutSwitchClick(),e.rippleEffect(),e.filledField()},hoverSearchText:function(){t(".search-text .text").focus(function(){"找东西？"==t(this).val()&&t(this).val("")}).blur(function(){""==t(this).val()&&t(this).val("找东西？")})},initial:function(e){this.adjustColumnHeights(e.clone()),t(".column--post").addClass("stop--sliding")},responsiveColumn:function(i){t(window).resize({viewModel:e},function(t){var e=t.data.viewModel;e.adjustColumnHeights(i.clone())})},layoutSwitchClick:function(){t("i.icon-layout").on("click",function(){var e=t(this),i=e.hasClass("icon-th"),o=e.hasClass("icon-th-list");i&&!e.hasClass("active")?(t("#post").removeClass("list--view").addClass("grid--view"),void RikaSite.prototype.setCookie("layout",1),e.siblings(".icon-th-list").removeClass("active"),e.addClass("active"),t(".column--post.column--invisible").removeClass("column--invisible"),RikaSite.prototype.adjustColumnHeights(t("#post .column--invisible .list--post").clone()),t(".column--invisible").removeClass("column--show")):o&&!e.hasClass("active")&&(t("#post").removeClass("grid--view").addClass("list--view"),void RikaSite.prototype.setCookie("layout",2),e.siblings(".icon-th").removeClass("active"),e.addClass("active"),t(".column--invisible").addClass("column--show"),t(".column--post ").addClass("column--invisible"))})},adjustColumnHeights:function(e){t(".column--one").empty(),t(".column--two").empty(),t(".column--three").empty();var i=[],o=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},n=1420,a=768;i.push(t(".column--one")),o()>=a&&i.push(t(".column--two")),o()>=n&&i.push(t(".column--three"));for(var l=0;l<e.length;l++)this.getTargetColumn(i).append(e.eq(l).addClass("post--item").removeClass("list--post"))},getTargetColumn:function(t){for(var e=Number.MAX_VALUE,i=0;i<t.length;i++)if(t[i].outerHeight()<e){var o=t[i];e=t[i].outerHeight()}return o},tagPost:function(){t(document).on("mouseenter",".tag ul > li:first-child",function(e){e.stopPropagation(),t(this).parents("ul").addClass("show")}),t(document).on("click",".tag ul > li",function(t){t.stopPropagation()}),t(document).on("mouseleave",".tag ul",function(e){e.stopPropagation(),t(this).removeClass("show")})},placeToolbar:function(e,i,o){var n=parseInt((t(window).width()-e+1)/2-i-o);20>n&&(n=20),t(".right-toolbar").css({right:n,opacity:1})},ajaxPostLoading:function(){var i=window.location.href;t(document).on("click",".container > .navigation a",{viewModel:e},function(e){e.preventDefault();var o=e.data.viewModel,n=t(this).attr("href");o.turnpage(n),history.pushState(null,document.title,n),i=window.location.href}),window.addEventListener("popstate",{viewModel:e},function(t){var e=window.location.href,o=t.data.viewModel;i!=e&&(o.turnpage(e),i=e)})},turnpage:function(e){t(".pageload-overlay").addClass("show"),t("html,body").animate({scrollTop:0},300),t(".column--post").addClass("fading"),t(".column--invisible").addClass("fading"),t.ajax({url:e}).always(function(e){var i=t.parseHTML(e);t("#post").html(t("#post",i).html()),t(".navigation").html(t(".navigation",i).html()),t(".wp-post-image").load(function(){RikaSite.prototype.initial(t("#post .column--invisible .list--post")),RikaSite.prototype.responsiveColumn(t("#post .column--invisible .list--post"))})})},navDropDownClick:function(){t(document).on("click",".open-nav",function(e){e.stopPropagation(),t("#nav-filters").toggleClass("open"),t(".box-overlay").addClass("open")}),t(document).on("click",".close-nav",function(){t(".nav-sidebar").removeClass("open"),t(".box-overlay").removeClass("open")})},navFilterClick:function(){t(document).on("click",".wrapper-dropdown",function(){t(this).toggleClass("active"),t.stopPropagation()}),t(document).on("click",".nav-sidebar",function(t){t.stopPropagation()}),t(document).on("click",function(){t(".nav-sidebar").removeClass("open"),t(".box-overlay").removeClass("open")})},searchClick:function(){t(document).on("click",".bt-search",function(){t(".search-text").hasClass("visible")?t(".search-text").removeClass("visible"):t(".search-text").addClass("visible"),setTimeout(function(){t(".search-text .text").trigger("focus")},200),setTimeout(function(){t(".search-text").removeClass("visible")},1e4)})},menuScroll:function(){t(window).scroll(function(e){e.stopPropagation();var i=t(window).scrollTop();i>48?(t("nav.search").removeClass("open"),t("body").addClass("header-fixed"),t(".main").addClass("white-bg")):(t("nav.search").hasClass("visible")&&t("nav.search").addClass("open"),t("body").removeClass("header-fixed"),t(".main").removeClass("white-bg"))})},dispalyMoblieMenu:function(){t(document).on("click","#menu-mobile .bt-menu",{viewModel:e},function(){t("#menu-mobile").hasClass("open")?t("#menu-mobile").removeClass("open"):t("#menu-mobile").addClass("open")})},toolBarPlace:function(){var e=!1;t(window).scroll(function(i){i.stopPropagation(),e=t(window).scrollTop()>=t(document).height()-t(window).height(),e?(t(".tooltip-goto").find(".icon-vertical_align_bottom").hide(),t(".tooltip-goto").find(".icon-vertical_align_top").show()):(t(".tooltip-goto").find(".icon-vertical_align_top").hide(),t(".tooltip-goto").find(".icon-vertical_align_bottom").show())})},upperDownClick:function(){t(document).on("click",".right-toolbar .icon-vertical_align_top",function(){t("html, body").animate({scrollTop:0},500)}),t(document).on("click",".right-toolbar .icon-vertical_align_bottom",function(){t("html, body").animate({scrollTop:t("#page-wrap").height()},500)}),t(document).on("click",".right-toolbar .icon-question_answer",function(){t("html, body").animate({scrollTop:t("#respond").position().top},500)}),t(document).on("click",".right-toolbar .icon-bubble_chart",function(){t("html, body").animate({scrollTop:t(".share").position().top},500)})},ScrollMenuMobile:function(){setTimeout(function(){t(".wrapper-nav").css("height",t(window).height()+"px")},500),t(window).resize(function(){setTimeout(function(){t(".wrapper-nav").css("height",t(window).height()+"px")},500)})},setCookie:function(t,e){var i=new Date;i.setTime(i.getTime()+31536e6),document.cookie=t+"="+e+";path=/;expires="+i.toUTCString()},rippleEffect:function(){var e=t(".rika-ripple");e.on("click.ui.ripple",function(e){var i=t(this),o=i.parent().offset(),n=i.find(".c-ripple__circle"),a=e.pageX-o.left,l=e.pageY-o.top;n.css({top:l+"px",left:a+"px"}),i.addClass("is-active")}),e.on("animationend webkitAnimationEnd oanimationend MSAnimationEnd",function(){t(this).removeClass("is-active")})},filledField:function(){var e=t(".rika-textfield");e.on("change",function(){t(this).children("input").val()?t(this).children("input").hasClass("is-filled")||t(this).children("input").addClass("is-filled"):t(this).children("input").hasClass("is-filled")&&t(this).children("input").removeClass("is-filled")})}};var e=new RikaSite;e.init()}),0<jQuery(".pivot-audio").length){var q="Microsoft Internet Explorer"==window.navigator.appName||"Netscape"==window.navigator.appName&&/trident\/\d\.\d/i.test(window.navigator.userAgent)?"flash, html":"html, flash",r=fx_ajax_url.swfurl;jQuery.getScript(fx_ajax_url.jplayerurl).done(function(){jQuery(".pivot-audio").each(function(){var t=jQuery(this),e=t.find(".xiami-cover"),i=t.attr("songid"),o=t.data("type");jQuery.ajax({type:"get",dataType:"json",jsonp:"callback",url:fx_ajax_url.ajax_url,data:{action:"fxjson",id:i,type:o},async:!1,beforeSend:function(){},success:function(i){if(200==i.msg){i=i.song,e.attr("style","background-image:url("+i.song_cover+")"),t.find(".audio-name").html(i.song_title),t.find(".audio-author").html(i.song_author);var o=t.children(".audio-jplayer");o.jPlayer({ready:function(){o.jPlayer("setMedia",{mp3:i.song_src}),t.hasClass("auto")&&o.jPlayer("play")},timeupdate:function(e){var i;if(i=e.jPlayer.status.currentTime,!isFinite(i)||0>i)i="--:--";else{var o=Math.floor(i/60);i=Math.floor(i)%60,i=(10>o?"0"+o:o)+":"+(10>i?"0"+i:i)}t.find(".play-timer").text(i),t.find(".play-prosess-bar").width(e.jPlayer.status.currentPercentAbsolute+"%")},play:function(){t.find(".play-button").addClass("playing")},pause:function(){t.find(".play-button").removeClass("playing")},ended:function(){t.find(".play-button").removeClass("playing")},swfPath:r,solution:q,volume:1,supplied:"mp3",wmode:"window",preload:"none"})}}})}),jQuery(".pivot-audio .play-button").click(function(){var t=jQuery(this).parent().parent().children(".audio-jplayer"),e=t.attr("id");jQuery(".pivot-audio").each(function(){var t=jQuery(this).children(".audio-jplayer");t.attr("id")!=e&&t.jPlayer("pause")}),t.data().jPlayer.status.paused?t.jPlayer("play"):t.jPlayer("pause")}),jQuery(".pivot-audio .play-prosess").click(function(t){var e=jQuery(this),i=e.parent().children(".audio-jplayer"),o=e.width(),e=e.offset().left;i.jPlayer("playHead",100*((t.pageX-e)/o))})}).fail(function(){window.console&&console.log("播放器初始化失败")})}jQuery(document).ready(function(){function t(){jQuery.ajax({url:"http://www.xiami.com/search/json?t=1&k="+e.val()+"&n=10&callback=jsonp978",type:"GET",dataType:"jsonp",success:function(t){t||console.log("sb");for(var e="",i=0;i<t.length;i++){var n=t[i];e+='<li class="add-xiamil" data-id="'+n.song_id+'"><div class="img"><img width="30" height="30" alt="爱你" src="http://img.xiami.net/'+n.album_logo+'"></div><div class="name"><p>'+n.song_name+"</p><p>"+n.artist_name+'</p></div><a class="play-btn"></a></li>'}e='<div class="search-title">歌曲</div><ul class="pads">'+e+"</ul>",o.empty(),o.html(e).show()}})}var e,i,e=jQuery(".js-search-input"),o=jQuery(".js-search-results"),n={bind_event:function(){e.bind("keyup",function(){""!=e.val()?(i&&clearTimeout(i),i=setTimeout(t,500)):""==e.val()&&o.empty().hide()})},unbind_event:function(){e.unbind("keyup")}};jQuery(document).click(function(t){!o.is(":visible")&&!o.is(":visible")||t.target||o.hide()}),e.focus(function(){n.bind_event()}).blur(function(){n.unbind_event()})});
//# sourceMappingURL=app.js.map

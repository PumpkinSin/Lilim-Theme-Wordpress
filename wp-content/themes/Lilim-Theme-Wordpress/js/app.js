function grin(o){var t;if(o=" "+o+" ",!document.getElementById("comment")||"textarea"!=document.getElementById("comment").type)return!1;if(t=document.getElementById("comment"),document.selection){t.focus();var e=document.selection.createRange();e.text=o,t.focus()}else if(t.selectionStart||"0"==t.selectionStart){var n=t.selectionStart,i=t.selectionEnd,a=i;t.value=t.value.substring(0,n)+o+t.value.substring(i,t.value.length),a+=o.length,t.focus(),t.selectionStart=a,t.selectionEnd=a}else t.value+=o,t.focus()}var RikaSite=RikaSite||{};if(jQuery(document).ready(function(o){"use strict";RikaSite=function(){},RikaSite.prototype={init:function(){var t=this,e=o("#post .column--invisible .list--post");t.hoverSearchText(),t.initial(e),t.placeToolbar(960,60,20),t.ajaxPostLoading(),t.responsiveColumn(e),t.navDropDownClick(),t.navFilterClick(),t.menuScroll(),t.upperDownClick(),t.toolBarPlace(),t.dispalyMoblieMenu(),t.tagPost(),t.ScrollMenuMobile(),t.searchClick(),t.layoutSwitchClick()},hoverSearchText:function(){o(".search-text .text").focus(function(){"找东西？"==o(this).val()&&o(this).val("")}).blur(function(){""==o(this).val()&&o(this).val("找东西？")})},initial:function(t){this.adjustColumnHeights(t.clone()),o(".column--post").addClass("stop--sliding")},responsiveColumn:function(e){o(window).resize({viewModel:t},function(o){var t=o.data.viewModel;t.adjustColumnHeights(e.clone())})},layoutSwitchClick:function(){o("i.icon-layout").on("click",function(){var t=o(this),e=t.hasClass("icon-th"),n=t.hasClass("icon-th-list");e&&!t.hasClass("active")?(o("#post").removeClass("list--view").addClass("grid--view"),void RikaSite.prototype.setCookie("layout",1),t.siblings(".icon-th-list").removeClass("active"),t.addClass("active"),o(".column--post.column--invisible").removeClass("column--invisible"),RikaSite.prototype.adjustColumnHeights(o("#post .column--invisible .list--post").clone()),o(".column--invisible").removeClass("column--show")):n&&!t.hasClass("active")&&(o("#post").removeClass("grid--view").addClass("list--view"),void RikaSite.prototype.setCookie("layout",2),t.siblings(".icon-th").removeClass("active"),t.addClass("active"),o(".column--invisible").addClass("column--show"),o(".column--post ").addClass("column--invisible"))})},adjustColumnHeights:function(t){o(".column--one").empty(),o(".column--two").empty(),o(".column--three").empty();var e=[],n=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},i=1420,a=768;e.push(o(".column--one")),n()>=a&&e.push(o(".column--two")),n()>=i&&e.push(o(".column--three"));for(var s=0;s<t.length;s++)this.getTargetColumn(e).append(t.eq(s).addClass("post--item").removeClass("list--post"))},getTargetColumn:function(o){for(var t=Number.MAX_VALUE,e=0;e<o.length;e++)if(o[e].outerHeight()<t){var n=o[e];t=o[e].outerHeight()}return n},tagPost:function(){o(document).on("mouseenter",".tag ul > li:first-child",function(t){t.stopPropagation(),o(this).parents("ul").addClass("show")}),o(document).on("click",".tag ul > li",function(o){o.stopPropagation()}),o(document).on("mouseleave",".tag ul",function(t){t.stopPropagation(),o(this).removeClass("show")})},placeToolbar:function(t,e,n){var i=parseInt((o(window).width()-t+1)/2-e-n);20>i&&(i=20),o(".right-toolbar").css({right:i,opacity:1})},ajaxPostLoading:function(){var e=window.location.href;o(document).on("click",".navigation a",{viewModel:t},function(t){t.preventDefault();var n=t.data.viewModel,i=o(this).attr("href");n.turnpage(i),history.pushState(null,document.title,i),e=window.location.href}),window.addEventListener("popstate",{viewModel:t},function(o){var t=window.location.href,n=o.data.viewModel;e!=t&&(n.turnpage(t),e=t)})},turnpage:function(t){o(".pageload-overlay").addClass("show"),o("html,body").animate({scrollTop:0},300),o(".column--post").addClass("fading"),o(".column--invisible").addClass("fading"),o.ajax({url:t}).always(function(t){var e=o.parseHTML(t);o("#post").html(o("#post",e).html()),o(".navigation").html(o(".navigation",e).html()),o(".wp-post-image").load(function(){RikaSite.prototype.initial(o("#post .column--invisible .list--post")),RikaSite.prototype.responsiveColumn(o("#post .column--invisible .list--post"))})})},navDropDownClick:function(){o(document).on("click",".open-nav",function(t){t.stopPropagation(),o("#nav-filters").toggleClass("open"),o(".box-overlay").addClass("open")}),o(document).on("click",".close-nav",function(){o(".nav-sidebar").removeClass("open"),o(".box-overlay").removeClass("open")})},navFilterClick:function(){o(document).on("click",".wrapper-dropdown",function(){o(this).toggleClass("active"),o.stopPropagation()}),o(document).on("click",".nav-sidebar",function(o){o.stopPropagation()}),o(document).on("click",function(){o(".nav-sidebar").removeClass("open"),o(".box-overlay").removeClass("open")})},searchClick:function(){o(document).on("click",".bt-search",function(){o(".search-text").hasClass("visible")?o(".search-text").removeClass("visible"):o(".search-text").addClass("visible"),setTimeout(function(){o(".search-text .text").trigger("focus")},200),setTimeout(function(){o(".search-text").removeClass("visible")},1e4)})},menuScroll:function(){o(window).scroll(function(t){t.stopPropagation();var e=o(window).scrollTop();e>48?(o("nav.search").removeClass("open"),o("body").addClass("header-fixed"),o(".main").addClass("white-bg")):(o("nav.search").hasClass("visible")&&o("nav.search").addClass("open"),o("body").removeClass("header-fixed"),o(".main").removeClass("white-bg"))})},dispalyMoblieMenu:function(){o(document).on("click","#menu-mobile .bt-menu",{viewModel:t},function(){o("#menu-mobile").hasClass("open")?o("#menu-mobile").removeClass("open"):o("#menu-mobile").addClass("open")})},toolBarPlace:function(){var t=!1;o(window).scroll(function(e){e.stopPropagation(),t=o(window).scrollTop()>=o(document).height()-o(window).height(),t?(o(".tool-goto").removeClass("tool-down icon-angle-down"),o(".tool-goto").addClass("tool-up icon-angle-up")):(o(".tool-goto").removeClass("tool-up icon-angle-up"),o(".tool-goto").addClass("tool-down icon-angle-down"))})},upperDownClick:function(){o(document).on("click",".right-toolbar .tool-up",function(){o("html, body").animate({scrollTop:0},500)}),o(document).on("click",".right-toolbar .tool-down",function(){o("html, body").animate({scrollTop:o("#page-wrap").height()},500)}),o(document).on("click",".right-toolbar .icon-bubbles",function(){o("html, body").animate({scrollTop:o("#respond").position().top},500)}),o(document).on("click",".right-toolbar .icon-share",function(){o("html, body").animate({scrollTop:o(".WPSNS_main").position().top},500)})},ScrollMenuMobile:function(){setTimeout(function(){o(".wrapper-nav").css("height",o(window).height()+"px")},500),o(window).resize(function(){setTimeout(function(){o(".wrapper-nav").css("height",o(window).height()+"px")},500)})},setCookie:function(o,t){var e=new Date;e.setTime(e.getTime()+31536e6),document.cookie=o+"="+t+";path=/;expires="+e.toUTCString()}};var t=new RikaSite;t.init()}),0<jQuery(".pivot-audio").length){var q="Microsoft Internet Explorer"==window.navigator.appName||"Netscape"==window.navigator.appName&&/trident\/\d\.\d/i.test(window.navigator.userAgent)?"flash, html":"html, flash",r=fx_ajax_url.swfurl;jQuery.getScript(fx_ajax_url.jplayerurl).done(function(){jQuery(".pivot-audio").each(function(){var o=jQuery(this),t=o.find(".xiami-cover"),e=o.attr("songid"),n=o.data("type");jQuery.ajax({type:"get",dataType:"json",jsonp:"callback",url:fx_ajax_url.ajax_url,data:{action:"fxjson",id:e,type:n},async:!1,beforeSend:function(){},success:function(e){if(200==e.msg){e=e.song,t.attr("style","background-image:url("+e.song_cover+")"),o.find(".audio-name").html(e.song_title),o.find(".audio-author").html(e.song_author);var n=o.children(".audio-jplayer");n.jPlayer({ready:function(){n.jPlayer("setMedia",{mp3:e.song_src}),o.hasClass("auto")&&n.jPlayer("play")},timeupdate:function(t){var e;if(e=t.jPlayer.status.currentTime,!isFinite(e)||0>e)e="--:--";else{var n=Math.floor(e/60);e=Math.floor(e)%60,e=(10>n?"0"+n:n)+":"+(10>e?"0"+e:e)}o.find(".play-timer").text(e),o.find(".play-prosess-bar").width(t.jPlayer.status.currentPercentAbsolute+"%")},play:function(){o.find(".play-button").addClass("playing")},pause:function(){o.find(".play-button").removeClass("playing")},ended:function(){o.find(".play-button").removeClass("playing")},swfPath:r,solution:q,volume:1,supplied:"mp3",wmode:"window",preload:"none"})}}})}),jQuery(".pivot-audio .play-button").click(function(){var o=jQuery(this).parent().parent().children(".audio-jplayer"),t=o.attr("id");jQuery(".pivot-audio").each(function(){var o=jQuery(this).children(".audio-jplayer");o.attr("id")!=t&&o.jPlayer("pause")}),o.data().jPlayer.status.paused?o.jPlayer("play"):o.jPlayer("pause")}),jQuery(".pivot-audio .play-prosess").click(function(o){var t=jQuery(this),e=t.parent().children(".audio-jplayer"),n=t.width(),t=t.offset().left;e.jPlayer("playHead",100*((o.pageX-t)/n))})}).fail(function(){window.console&&console.log("播放器初始化失败")})}jQuery(document).ready(function(){function o(){jQuery.ajax({url:"http://www.xiami.com/search/json?t=1&k="+t.val()+"&n=10&callback=jsonp978",type:"GET",dataType:"jsonp",success:function(o){o||console.log("sb");for(var t="",e=0;e<o.length;e++){var i=o[e];t+='<li class="add-xiamil" data-id="'+i.song_id+'"><div class="img"><img width="30" height="30" alt="爱你" src="http://img.xiami.net/'+i.album_logo+'"></div><div class="name"><p>'+i.song_name+"</p><p>"+i.artist_name+'</p></div><a class="play-btn"></a></li>'}t='<div class="search-title">歌曲</div><ul class="pads">'+t+"</ul>",n.empty(),n.html(t).show()}})}var t,e,t=jQuery(".js-search-input"),n=jQuery(".js-search-results"),i={bind_event:function(){t.bind("keyup",function(){""!=t.val()?(e&&clearTimeout(e),e=setTimeout(o,500)):""==t.val()&&n.empty().hide()})},unbind_event:function(){t.unbind("keyup")}};jQuery(document).click(function(o){!n.is(":visible")&&!n.is(":visible")||o.target||n.hide()}),t.focus(function(){i.bind_event()}).blur(function(){i.unbind_event()})});
//# sourceMappingURL=app.js.map